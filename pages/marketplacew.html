<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Marketplace (Tailwind v4 Only)</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="../global.css">
    <script src="../components/navbar.js"></script>
    <style type="text/tailwindcss">
      @theme {
        --color-volcano-red: #c53030;
        --color-ash-gray: #2d3748;
        --color-lava-orange: #ed8936;
        --color-earth-cream: #fffaf0;
        --color-forest-green: #38a169;
        --color-warm-gray: #f7fafc;
        --color-dark-gray: #4a5568;
      }
    </style>
  </head>
  <body class="bg-warm-gray min-h-screen font-sans">
    <!-- Cart Toggle Button -->
    <button
      id="cartToggle"
      class="fixed bottom-6 right-6 z-50 bg-volcano-red hover:bg-volcano-red/90 text-white p-4 rounded-2xl shadow-lg transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl"
      aria-label="Toggle cart"
    >
      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5 6m0 0h12"></path>
      </svg>
      <span id="cartCount" class="absolute -top-2 -right-2 bg-lava-orange text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold transition-all duration-300">0</span>
    </button>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
      <!-- Hero Section -->
      <header class="text-center mb-12 rounded-3xl px-8 py-24 mx-4 bg-white/80 backdrop-blur-sm border border-white/50 transition-all duration-500">
        <h1 class="text-6xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 text-volcano-red transition-all duration-300">Marketplace</h1>
        <p class="text-dark-gray text-xl max-w-2xl mx-auto leading-relaxed transition-all duration-300">
          Temukan produk daur ulang berkualitas. Marketplace ramah lingkungan untuk masa depan yang berkelanjutan.
        </p>
      </header>

      <!-- Category Filter -->
      <section class="mb-12">
        <div class="flex flex-wrap justify-center gap-4">
          <button onclick="filterProducts('all', this)" class="category-btn px-6 py-3 bg-volcano-red text-white rounded-2xl font-semibold shadow-md transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
            Semua Produk
          </button>
          <button onclick="filterProducts('furniture', this)" class="category-btn px-6 py-3 bg-white text-dark-gray rounded-2xl font-semibold shadow-md hover:bg-volcano-red hover:text-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
            Furniture
          </button>
          <button onclick="filterProducts('fashion', this)" class="category-btn px-6 py-3 bg-white text-dark-gray rounded-2xl font-semibold shadow-md hover:bg-volcano-red hover:text-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
            Fashion
          </button>
          <button onclick="filterProducts('home', this)" class="category-btn px-6 py-3 bg-white text-dark-gray rounded-2xl font-semibold shadow-md hover:bg-volcano-red hover:text-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
            Rumah Tangga
          </button>
          <button onclick="filterProducts('garden', this)" class="category-btn px-6 py-3 bg-white text-dark-gray rounded-2xl font-semibold shadow-md hover:bg-volcano-red hover:text-white transition-all duration-300 hover:-translate-y-1 hover:shadow-lg">
            Taman
          </button>
        </div>
      </section>

      <!-- Product Grid -->
      <section id="products" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8"></section>
    </div>

    <!-- Cart Sidebar -->
    <aside id="cart" class="fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-2xl z-50 transform translate-x-full transition-transform duration-500 ease-in-out">
      <div class="p-6 h-full flex flex-col">
        <div class="flex justify-between items-center mb-6 border-b border-gray-200 pb-4">
          <h2 class="text-2xl font-bold text-ash-gray">Keranjang Anda</h2>
          <button id="closeCart" class="text-dark-gray hover:text-volcano-red bg-gray-100 hover:bg-gray-200 rounded-full w-10 h-10 flex items-center justify-center transition-all duration-300 hover:scale-110">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>

        <div id="cartItems" class="flex-1 overflow-y-auto space-y-4">
          <div class="text-center text-gray-500 py-8">
            <svg class="w-16 h-16 mx-auto mb-4 text-gray-300 transition-all duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5 6m0 0h12"></path>
            </svg>
            <p class="transition-all duration-300">Keranjang kosong</p>
          </div>
        </div>

        <div class="border-t border-gray-200 pt-4 mt-4">
          <div class="flex justify-between items-center mb-4">
            <span class="text-lg font-semibold text-ash-gray">Total:</span>
            <span id="cartTotal" class="text-xl font-bold text-forest-green transition-all duration-300">Rp 0</span>
          </div>
          <button id="checkoutBtn" class="w-full bg-volcano-red text-white py-3 px-6 rounded-2xl font-semibold hover:bg-volcano-red/90 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 hover:-translate-y-1 hover:shadow-xl" disabled>
            Lanjut ke Checkout
          </button>
        </div>
      </div>
    </aside>

    <!-- Cart Overlay -->
    <div id="cartOverlay" class="fixed inset-0 bg-black/50 z-40 opacity-0 pointer-events-none transition-opacity duration-300 backdrop-blur-sm"></div>

    <script>
      // Simple product data
      const products = [
        { id: 1, name: "Meja Kayu Palet Bekas", price: 450000, category: "furniture", image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='%23F4F1E7'/%3E%3Crect x='50' y='80' width='200' height='80' fill='%236A8E4E' rx='8'/%3E%3Crect x='70' y='100' width='160' height='8' fill='%23992E1A'/%3E%3Crect x='70' y='120' width='160' height='8' fill='%23992E1A'/%3E%3Crect x='70' y='140' width='160' height='8' fill='%23992E1A'/%3E%3Ctext x='150' y='50' text-anchor='middle' font-size='16' fill='%23992E1A'%3Eâ™»ï¸ MEJA%3C/text%3E%3C/svg%3E" },
        { id: 2, name: "Tas Tote Kain Bekas", price: 85000, category: "fashion", image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='%23F4F1E7'/%3E%3Cpath d='M100 60 L100 160 L200 160 L200 60 Z' fill='%234C4C4C'/%3E%3Cpath d='M110 50 L110 70 M190 50 L190 70' stroke='%23992E1A' stroke-width='6' stroke-linecap='round'/%3E%3Ctext x='150' y='30' text-anchor='middle' font-size='12' fill='%23992E1A'%3Eâ™»ï¸ TAS TOTE%3C/text%3E%3C/svg%3E" },
        { id: 3, name: "Pot Tanaman Botol Plastik", price: 25000, category: "garden", image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='%23F4F1E7'/%3E%3Cpath d='M130 50 L130 40 Q130 30 140 30 L160 30 Q170 30 170 40 L170 50 L180 60 L180 150 Q180 160 170 160 L130 160 Q120 160 120 150 L120 60 Z' fill='%236A8E4E'/%3E%3Ccircle cx='150' cy='110' r='15' fill='%23992E1A'/%3E%3Ctext x='150' y='20' text-anchor='middle' font-size='12' fill='%23992E1A'%3Eâ™»ï¸ POT%3C/text%3E%3C/svg%3E" },
        { id: 4, name: "Lampu Hias Kaca Bekas", price: 175000, category: "home", image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='%23F4F1E7'/%3E%3Ccircle cx='150' cy='100' r='50' fill='%23D97424' fill-opacity='0.6'/%3E%3Ccircle cx='150' cy='100' r='30' fill='%23992E1A' fill-opacity='0.8'/%3E%3Cline x1='150' y1='50' x2='150' y2='30' stroke='%23992E1A' stroke-width='3'/%3E%3Ctext x='150' y='20' text-anchor='middle' font-size='12' fill='%23992E1A'%3Eâ™»ï¸ LAMPU%3C/text%3E%3C/svg%3E" },
        { id: 5, name: "Kursi Ban Bekas Motor", price: 320000, category: "furniture", image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='%23F4F1E7'/%3E%3Ccircle cx='150' cy='120' r='40' fill='%234C4C4C'/%3E%3Ccircle cx='150' cy='120' r='20' fill='%23F4F1E7'/%3E%3Crect x='130' y='80' width='40' height='40' fill='%23992E1A' rx='20'/%3E%3Ctext x='150' y='50' text-anchor='middle' font-size='12' fill='%23992E1A'%3Eâ™»ï¸ KURSI%3C/text%3E%3C/svg%3E" },
        { id: 6, name: "Jaket Denim Upcycled", price: 285000, category: "fashion", image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='%23F4F1E7'/%3E%3Cpath d='M120 60 L120 160 L180 160 L180 60 L170 50 L130 50 Z' fill='%234C4C4C'/%3E%3Cpath d='M140 70 L140 90 M160 70 L160 90' stroke='%23D97424' stroke-width='3'/%3E%3Ctext x='150' y='40' text-anchor='middle' font-size='12' fill='%23992E1A'%3Eâ™»ï¸ JAKET%3C/text%3E%3C/svg%3E" },
        { id: 7, name: "Rak Buku Kayu Palet", price: 380000, category: "furniture", image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='%23F4F1E7'/%3E%3Crect x='80' y='60' width='140' height='100' fill='%236A8E4E'/%3E%3Cline x1='85' y1='90' x2='215' y2='90' stroke='%23992E1A' stroke-width='2'/%3E%3Cline x1='85' y1='120' x2='215' y2='120' stroke='%23992E1A' stroke-width='2'/%3E%3Ctext x='150' y='45' text-anchor='middle' font-size='12' fill='%23992E1A'%3Eâ™»ï¸ RAK BUKU%3C/text%3E%3C/svg%3E" },
        { id: 8, name: "Tempat Pensil Kaleng Bekas", price: 35000, category: "home", image: "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='200' viewBox='0 0 300 200'%3E%3Crect width='300' height='200' fill='%23F4F1E7'/%3E%3Crect x='130' y='80' width='40' height='80' fill='%23D97424' rx='20'/%3E%3Cline x1='135' y1='60' x2='135' y2='80' stroke='%23992E1A' stroke-width='2'/%3E%3Cline x1='150' y1='60' x2='150' y2='80' stroke='%23992E1A' stroke-width='2'/%3E%3Cline x1='165' y1='60' x2='165' y2='80' stroke='%23992E1A' stroke-width='2'/%3E%3Ctext x='150' y='50' text-anchor='middle' font-size='10' fill='%23992E1A'%3Eâ™»ï¸ TEMPAT PENSIL%3C/text%3E%3C/svg%3E" }
      ];

      let cart = [];
      let currentFilter = 'all';

      const categoryNames = {
        furniture: "Furniture",
        fashion: "Fashion", 
        home: "Rumah Tangga",
        garden: "Taman"
      };

      // Format currency
      function formatPrice(price) {
        return new Intl.NumberFormat('id-ID', {
          style: 'currency',
          currency: 'IDR',
          minimumFractionDigits: 0
        }).format(price);
      }

      // Render products
      function renderProducts() {
        const filteredProducts = currentFilter === 'all' 
          ? products 
          : products.filter(p => p.category === currentFilter);

        document.getElementById('products').innerHTML = filteredProducts.map(product => `
          <div class="bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-200 transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl hover:border-volcano-red/20">
            <div class="relative overflow-hidden group">
              <img src="${product.image}" alt="${product.name}" class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105">
              <div class="absolute top-4 left-4">
                <span class="px-3 py-1 bg-lava-orange text-white text-xs rounded-full font-medium shadow-sm transition-all duration-300">${categoryNames[product.category]}</span>
              </div>
              <div class="absolute inset-0 bg-gradient-to-t from-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            </div>
            <div class="p-6">
              <h3 class="text-lg font-semibold text-ash-gray mb-3 transition-colors duration-300 hover:text-volcano-red">${product.name}</h3>
              <div class="flex justify-between items-center">
                <span class="text-2xl font-bold text-forest-green transition-all duration-300">${formatPrice(product.price)}</span>
                <button onclick="addToCart(${product.id})" class="bg-volcano-red hover:bg-volcano-red/90 text-white p-2 rounded-full shadow-md transition-all duration-300 hover:scale-110 hover:-translate-y-1 hover:shadow-lg">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
        `).join('');
      }

      // Filter products
      function filterProducts(category, button) {
        currentFilter = category;
        
        // Update button states
        document.querySelectorAll('.category-btn').forEach(btn => {
          btn.classList.remove('bg-volcano-red', 'text-white');
          btn.classList.add('bg-white', 'text-dark-gray');
        });
        button.classList.remove('bg-white', 'text-dark-gray');
        button.classList.add('bg-volcano-red', 'text-white');
        
        renderProducts();
      }

      // Add to cart
      function addToCart(productId) {
        const product = products.find(p => p.id === productId);
        const existingItem = cart.find(item => item.id === productId);
        
        if (existingItem) {
          existingItem.quantity += 1;
        } else {
          cart.push({ ...product, quantity: 1 });
        }
        
        updateCart();
        
        // Visual feedback
        const cartButton = document.getElementById('cartToggle');
        cartButton.classList.add('scale-110');
        setTimeout(() => cartButton.classList.remove('scale-110'), 200);
      }

      // Remove from cart
      function removeFromCart(productId) {
        cart = cart.filter(item => item.id !== productId);
        updateCart();
      }

      // Update cart UI
      function updateCart() {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

        document.getElementById('cartCount').textContent = totalItems;
        document.getElementById('cartTotal').textContent = formatPrice(totalPrice);
        
        const cartItems = document.getElementById('cartItems');
        const checkoutBtn = document.getElementById('checkoutBtn');

        if (cart.length === 0) {
          cartItems.innerHTML = `
            <div class="text-center text-gray-500 py-8">
              <svg class="w-16 h-16 mx-auto mb-4 text-gray-300 transition-all duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5 6m0 0h12"></path>
              </svg>
              <p class="transition-all duration-300">Keranjang kosong</p>
            </div>
          `;
          checkoutBtn.disabled = true;
        } else {
          cartItems.innerHTML = cart.map(item => `
            <div class="bg-gray-50 p-4 rounded-2xl flex items-center space-x-4 border border-gray-200 transition-all duration-300 hover:bg-gray-100 hover:border-volcano-red/30 hover:shadow-md">
              <img src="${item.image}" alt="${item.name}" class="w-16 h-16 rounded-xl object-cover border border-gray-200 transition-all duration-300">
              <div class="flex-1">
                <h4 class="font-semibold text-ash-gray text-sm transition-colors duration-300">${item.name}</h4>
                <p class="text-dark-gray text-sm transition-all duration-300">Qty: ${item.quantity}</p>
                <p class="text-forest-green font-bold transition-all duration-300">${formatPrice(item.price * item.quantity)}</p>
              </div>
              <button onclick="removeFromCart(${item.id})" class="text-volcano-red hover:text-volcano-red/80 bg-red-50 hover:bg-red-100 rounded-full w-8 h-8 flex items-center justify-center transition-all duration-300 hover:scale-110">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
              </button>
            </div>
          `).join('');
          checkoutBtn.disabled = false;
        }
      }

      // Toggle cart
      function toggleCart() {
        const cartSidebar = document.getElementById('cart');
        const overlay = document.getElementById('cartOverlay');
        
        cartSidebar.classList.toggle('translate-x-full');
        
        if (cartSidebar.classList.contains('translate-x-full')) {
          overlay.classList.add('opacity-0', 'pointer-events-none');
          document.body.classList.remove('overflow-hidden');
        } else {
          overlay.classList.remove('opacity-0', 'pointer-events-none');
          document.body.classList.add('overflow-hidden');
        }
      }

      // Event listeners
      document.getElementById('cartToggle').addEventListener('click', toggleCart);
      document.getElementById('closeCart').addEventListener('click', toggleCart);
      document.getElementById('cartOverlay').addEventListener('click', toggleCart);
      
      document.getElementById('checkoutBtn').addEventListener('click', () => {
        alert('ðŸŒ‹ Checkout functionality - connect to your payment system!');
      });

      // Initialize
      renderProducts();
      updateCart();
    </script>
  </body>
</html>